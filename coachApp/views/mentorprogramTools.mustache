<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>User Profile</title>
        <link href="https://fonts.googleapis.com/css2?family=Mrs+Sheppards&family=Open+Sans&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
      </head>
<body style="background-color: whitesmoke;">

    <style>

    :root {
        --primary: #ED760F;
        --light: #dfe5f7;
        --dark: #27036A;
        --text:#FEFEB7;
    }
    body{
        background:whitesmoke;
    }
    header{
        position: relative;
        z-index: 100;
    }
    .courseOverview{
        display: flex;
        flex-direction: row;
        background-color: whitesmoke;
        margin: 5% 0;
        padding: 50px;
        height: fit-content;
        margin-bottom: 0;
    }
    .more{
        display: flex;
        flex-direction: row;
        margin:0;
        padding: 20px;
        height: fit-content;
    }
    .left{
        flex: 60%;
        color:var(--dark);
        text-align: justify;
        margin-left: 3%;
    }
    .right{
        flex: 40%;
    }
    .bigEnroll{
        margin-top: 5%;
        background-color: #27036A;
        color: var(--text);
        height:65px;
        width: 150px;
        text-align: center;
        border: none;
        border-radius: 10px;
    }
    #leftPoints{
        list-style: none;
    }
    .breadcrumb {
        background-color: white;
        overflow: hidden;
        margin-left:10%;
        color: #333;
        
    }

.breadcrumb a {
  float: left;
  display: block;
  padding: 15px;
  text-decoration: none;
  color: #D9D9D9;
  font-weight: bold;
  margin-right: 20px;
  border-radius: 10px;
  transition: background-color 0.3s;
  
}

.breadcrumb a:hover {
  background-color: #ED760F;
  color: #FEFEB7;
}

.content {
  display: none;
  width: 50%;
  min-height: 250px;
  padding: 20px;
  padding-left: 7%;
  background-color: white;
  transition: transform 10s ease-in-out;

}

.content.active {
  display: block;
  transform: translateX(0);
}

/* Add a transition effect for the sliding animation */
.content:not(.active) {
  transform: translateX(-100%);
}

.modal {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgb(0,0,0);
  background-color: rgba(0,0,0,0.4);
  padding-top: 60px;
}
#modal-content{
  background: #FEFEB7;
  margin: 10% auto;
  padding: 20px;
  width: 50%;
  border-radius: 8px;
  color: #27036A;
}


.close {
  color: #e16868;
  float: right;
  font-size: 30px;
  font-weight: bold;
  margin-left: 90%;
  margin-bottom: 40px;
}

.close:hover,
.close:focus {
  color: #ED760F;
  text-decoration: none;
  cursor: pointer;
}
#editForm{
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px; 
    max-width: 400px; 
    margin: auto; 
}
#editForm label {
    display: block;
    margin-bottom: 5px;
    color: #27036A;
  }

#editForm input {
    width: 100%;
    padding: 8px;
    margin-bottom: 10px;
    border:1px #ED760F;
    border-radius: 3px;
  }

  #editForm button{
  flex: 1;  
  background-color:#27036A;
  color: #FEFEB7;
  border: none;
  border-radius: 5px;
  padding: 10px 20px;
  cursor: pointer;
  font-size: 16px;
  width: 200px;
  margin-top: 4%;
  margin-left:auto;
  margin-right: auto;
}
#editForm button:hover{
    background-color: palevioletred;
}
.welcomemessage {
            min-height: 250px;
            border-radius: 15px;
            width: 80%;
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            opacity: 0;
            transition: opacity 2s ease-in-out;
            text-align: center;
            border: 2px solid #D9D9D9;
            color: #27036A;
            z-index: 100;
}
        .confirmation-dialog {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border: 1px solid #ccc;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        .dialog-content {
            text-align: center;
        }

        .confirmation-dialog button {
            margin: 0 10px;
            padding: 5px 10px;
            cursor: pointer;
        }

    </style>

    <header>
        {{>mentorheader}}
    </header>
{{#program}}
<section>
   <div class="courseOverview" id="programContainer" data-program-id="{{_id}}">
    <div class="left">
       <h1 style="font-weight: bold;">{{program}}</h1><br>
       <h2 style="color: grey; font-weight: bold;">{{creator}}</h2><br>
       <p style="color: gray;">{{description}}</p><br>
       <p style="color: gray;">{{venue}}</p>
       <p style="color: gray;">{{category}}</p>

       <h4 style="color: #D9D9D9;">Over 12 resouces available</h4>
       <button onclick="openDialog('{{program}}','{{creator}}')" class="bigEnroll">
        Delete<br>
         <span><small>Starts Dec 14</small></span>
       </button> 
    </div>
    <div class="right">
        <button class="bigEnroll" onclick="openModal()">
            Edit
       </button>
    </div>
    </div>

    <div class="more">    
   
        <h2 style=" font-weight: bold; color: #27036A; margin-left:15% ;text-align: center;">What additional information is there about this program?</h2>
    
    </div>

</section>
<div class="row" style="display: flex; flex-direction: row;">
<div class="allofus" style="background-color: white; padding:10px; flex:50%; margin-left: 4%; border-radius: 20px;margin-bottom: 400px;">
    <nav class="breadcrumb">
        <a href="#Goals">Goals</a>
        <a href="#Skills">Skills</a>
        <a href="#Projection">Projection</a>
      </nav>
    
      <div id="Goals" class="content">
        <h2>Goals Content</h2>
        <p id="goalsText">Goals include:{{goals}}</p>
        <button onclick="editContent('goalsText')" class="edit-btn"><i class="fa fa-edit"></i> Edit</button>
      </div>
      
      <div id="Skills" class="content">
        <h2>Skills Content</h2>
        <p id="skillsText">Skills You will gain:{{skills}}</p>
        <button onclick="editContent('skillsText')" class="edit-btn"><i class="fa fa-edit"></i> Edit</button>
      </div>
      
      <div id="Projection" class="content">
        <h2>Projection Content</h2>
        <p id="projectionText">What is the expected projection?{{projection}}</p>
        <button onclick="editContent('projectionText')" class="edit-btn"><i class="fa fa-edit"></i> Edit</button>
      </div>
</div>
<div class="file-input" style="flex: 30%; height: 250px;padding: 30px; background-color: #dfe5f7; border-radius:10px; margin-left: 30px; margin-right: 30px;"
 >
    <form method="POST" action="/upload-resource" enctype="multipart/form-data">
        <h2> Resources Upload</h2><br><br>
        <input type="file" name="resource" accept="*/*">
        <button type="submit">Upload Resource</button>
    </form>
</div>
</div>

<div id="resource-list">
</div>

<div id="myModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content" id="modal-content">
      <span style="color: #e16868;" class="close" onclick="closeModal()">&times;</span>
      <!-- Your form content goes here -->
      <form id="editForm" method="POST" action="/mentor/edit/:program/:creator" onsubmit="return validateForm()">
        <input type="hidden" id="programData"  name="initialname" value="{{program}}">
        <input type="hidden" id="creatorData" name="creator" value="{{creator}}">
        <label for="program"> Program Name:</label>
        <input type="text" id="program" name="program" required>
        <label for="date">Start Date:</label>
        <input type="date" id="date" name="date" required>
        <label for="edate">End Date:</label>
        <input type="date" id="endDate" name="endDate" required>
        <label for="venue">Venue</label>
        <input type="text" id="venue" name="venue" required>
        <label for="category">Select a Service:</label>
        <select id="category" name="category">
            <option value="Career Advice">Career Advice</option>
            <option value="Resume Review">Resume Review</option>
            <option value="Mock Interview">Mock Interview</option>
        </select>
        <button type="submit" class="edit-btn">edit</button>
        <button type="button" class="close" onclick="closeModal()">Cancel</button>
  
  
      </form>
    </div>
  
  </div>
{{/program}}

<div id="confirmationDialog" class="confirmation-dialog">
    <form action="/mentor/program/delete" method="POST"> 
    <div class="dialog-content">
        <input type="hidden" id="dialogProgram"  name="program" >
        <input type="hidden" id="dialogCreator" name="creator" >
        <p>Are you sure you want to Delete this program?</p>
        <button id="confirmUnenroll"  type="submit">Yes</button>
        <button  type="button" onclick="closeDialog()"  id="cancelUnenroll">No</button>
    </div>
</form>
</div>


<div class="welcomemessage">
    <h1 style="color:#27036A; font-weight: bold;">How was your experience</h1>
  
    <p style="color: grey;">Mentorship is a powerful and impactful practice that has been instrumental in personal and 
        professional development across various fields. At its core, mentorship is a
         relationship in which a more experienced or knowledgeable person helps to guide a less 
         experienced or less knowledgeable person. However, it's much more than just passing on knowledge; 
        it's about fostering growth, providing support, and sharing experiences and insights.</p>
  
  </div>

<footer>
    {{>footer}}
</footer>

<script>

function validateForm() {
    const startDate = document.getElementById('date').value;
    const endDate = document.getElementById('endDate').value;

    // Convert input dates to Date objects
    const start = new Date(startDate);
    const end = new Date(endDate);
    const currentDate = new Date();
    currentDate.setHours(0, 0, 0, 0); // Remove time component

    // Check if dates are in the past
    if (start < currentDate || end < currentDate) {
        alert("Dates cannot be in the past.");
        return false;
    }

    // Check if start date is before end date
    if (start > end) {
        alert("Start date must be before end date.");
        return false;
    }

    return true; // Allow form submission
}


function openDialog(program,creator){

document.getElementById('dialogProgram').value=program;
document.getElementById('dialogCreator').value=creator;
document.getElementById("confirmationDialog").style.display = "block";

}    

function closeDialog(){

document.getElementById("confirmationDialog").style.display = "none";
}      


function openModal() {

document.getElementById('myModal').style.display = 'block';
// const form = document.querySelector('#editForm');
//     form.action = `/mentor/edit/${program}/${creator}`;
}

function closeModal() {
document.getElementById('myModal').style.display = 'none';
}    

document.addEventListener('DOMContentLoaded', function () {
      const breadcrumbLinks = document.querySelectorAll('.breadcrumb a');
      
      breadcrumbLinks.forEach(link => {
        link.addEventListener('click', function (event) {
          event.preventDefault();

          const contentId = link.getAttribute('href').substring(1);
          showContent(contentId);
        });
      });

      function showContent(contentId) {
        const allContents = document.querySelectorAll('.content');
        
        allContents.forEach(content => {
          content.classList.remove('active');
        });

        const selectedContent = document.getElementById(contentId);
        selectedContent.classList.add('active');
      }
    });


function updateProgram(programId, data) {
  $.ajax({
    url: `/programs/${programId}`,
    method: 'PATCH',
    contentType: 'application/json',
    data: JSON.stringify(data),
    success: function(response) {
      console.log('Program updated', response);
    },
    error: function(xhr, status, error) {
      console.error('Update failed', status, error);
    }
  });
}

function editContent(contentId) {
    var content = document.getElementById(contentId);
    var textArea = document.createElement('textarea');
    textArea.id = contentId;
    textArea.className = 'edit-textarea';
    textArea.value = content.innerText;
    content.parentNode.replaceChild(textArea, content);
    
    var editButton = document.querySelector(`button[onclick="editContent('${contentId}')"]`);
    editButton.innerText = 'Save';
    editButton.onclick = function() {
    editButton.classList.add("edit-save-btn"); 
      saveContent(contentId);
    };
  }

  function saveContent(contentId) {
    var textArea = document.getElementById(contentId);
    var p = document.createElement('p');
    p.id = contentId;
    p.innerText = textArea.value;
    var parentElement = textArea.parentNode; // Get the parent element of textArea
    parentElement.replaceChild(p, textArea);

    var programElement = document.getElementById('programContainer');
    var programId = programElement.getAttribute('data-program-id');

    var saveButton = document.querySelector('.edit-save-btn');
    saveButton.innerText = 'Edit';
    saveButton.onclick = function() {
    editContent(contentId);
    };
    
    var data = {};
    data[contentId.replace('Text', '')] = p.innerText; 
    updateProgram(programId, data); 
}


</script>

</body>
</html>
